let restaurant,map;function initMap(){fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})}function fetchRestaurantFromURL(e){if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(n,r)=>{self.restaurant=r,r?(fetchReviewsFromURL(t,e=>{reviews?fillRestaurantHTML():console.error(e)}),e(null,r)):console.error(n)}):e("No restaurant id in URL",null)}function fetchReviewsFromURL(e,t){self.review?t(null,self.reviews):e?DBHelper.fetchReviewsByRestaurantId(e,(e,n)=>{self.reviews=n,n?t(null,n):console.error(e)}):t("No restaurant id in URL",null)}function fillRestaurantHTML(e=self.restaurant){document.getElementsByClassName("restaurant__name")[0].innerHTML=e.name,document.getElementsByClassName("restaurant__address")[0].innerHTML=e.address;const t=document.getElementsByClassName("restaurant__image")[0];t.src=DBHelper.imageUrlForRestaurant(e),t.alt=["restaurant",e.name,e.neighborhood].join(" ").toLowerCase(),document.getElementsByClassName("restaurant__cuisine")[0].innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()}function fillRestaurantHoursHTML(e=self.restaurant.operating_hours){const t=document.getElementsByClassName("restaurant__hours")[0];for(key in e)if(e.hasOwnProperty(key)){const n=document.createElement("tr"),r=document.createElement("td");r.innerHTML=key,r.tabIndex=0,n.appendChild(r);const a=document.createElement("td");a.innerHTML=e[key],a.tabIndex=0,n.appendChild(a),t.appendChild(n)}}function fillReviewsHTML(e=self.reviews){const t=document.getElementsByClassName("reviews")[0],n=document.createElement("h3");if(n.innerHTML="Reviews",t.appendChild(n),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const r=document.getElementsByClassName("reviews-list")[0];e.forEach(e=>{r.appendChild(createReviewHTML(e))}),t.appendChild(r)}function createReviewHTML(e){const t=document.createElement("li"),n=document.createElement("p");n.innerHTML=e.name,t.appendChild(n);const r=document.createElement("p");r.innerHTML=new Date(e.updatedAt||e.createdAt).toLocaleString(),t.appendChild(r);const a=document.createElement("p");a.innerHTML=`Rating: ${e.rating}`,t.appendChild(a);const s=document.createElement("p");return s.innerHTML=e.comments,t.appendChild(s),t}function fillBreadcrumb(e=self.restaurant){const t=document.getElementsByClassName("breadcrumb")[0].getElementsByTagName("ol")[0],n=document.createElement("li");n.innerHTML=e.name,n.setAttribute("aria-current","page"),t.appendChild(n)}function getParameterByName(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}